def createSlidingWindowSet_by_date(data, dates):
    seqs_by_date = []
    unique_dates = torch.unique(dates)

    for date in unique_dates:
        seqs_by_date.append(data[dates == date])

    slides = []
    for i in range(len(seqs_by_date) - WINDOW_SIZE - TARGET_SIZE):
        input_window = seqs_by_date[i:i+WINDOW_SIZE]
        target_window = seqs_by_date[i+WINDOW_SIZE:i+WINDOW_SIZE+TARGET_SIZE]
        target_consensus = get_consensus(target_window)

        slides.append(torch.tensor(input_window), target_consensus)

    return slides